conky.config = {
-- Включает поддержку Xft (X FreeType) для рендеринга шрифтов с сглаживанием и антиалиасингом; улучшает качество текста на экране
use_xft = true,

-- Устанавливает глобальный шрифт и его размер (в пунктах); влияет на весь текст в Conky, можно указать путь к TTF/OTF файлу
font = 'DejaVu Sans:size=12',

-- Задаёт прозрачность (альфа-канал) для Xft-шрифтов; значение от 0.0 (полностью прозрачный) до 1.0 (непрозрачный); полезно для наложения на фон
xftalpha = 0.8,

-- Интервал обновления всего Conky в секундах; меньшее значение (например, 1.0) для динамичных данных (CPU/RAM), большее — для экономии CPU
update_interval = 3.0,

-- Количество циклов обновления (0 = бесконечно); используй 1 для однократного запуска или положительное число для теста
total_run_times = 0,

-- Оконные настройки
-- Создаёт собственное окно для Conky (false = рисует в корневом окне); обязательно для прозрачности и позиционирования
own_window = true,
-- own_window_type влияет на отображение, значения normal, desktop, override
-- Тип окна: 'normal' — обычное (видно в оконном менеджере), 'desktop' — на фоне рабочего стола (игнорирует WM), 'override' — переопределяет WM (для композиторов); 'desktop' идеально для панелей
own_window_type = 'normal',
-- Класс окна для WM (используется в правилах i3/bspwm); помогает WM распознавать и управлять окном Conky
own_window_class = 'Conky',
-- Делает фон окна прозрачным (требует композитора вроде Compton/Picom); без него — сплошной фон
own_window_transparent = true,
-- Фиксирует размер окна (не меняется при обновлениях); полезно для стабильного позиционирования, но может обрезать текст
own_window_fixed_size = true,
-- Включает ARGB-визуалы для per-pixel альфы (прозрачность по пикселям); требуется композитор, иначе текст дублируется или артефакты
-- argb можно закомментировать при задвоении текста или сменить композитор, влияет на прозрачность
own_window_argb_visual = true,
-- Уровень прозрачности всего окна (0-255; 0 = полностью прозрачный фон, 255 = непрозрачный); комбинируется с own_window_transparent
own_window_argb_value = 0,
-- WM-хинты: 'undecorated' — без рамки/заголовка, 'sticky' — прилипает к виртуальным десктопам, 'skip_taskbar/skip_pager' — не показывается в панели/пагере, 'below' — под всеми окнами (на фоне)
own_window_hints = 'undecorated,sticky,skip_taskbar,skip_pager,below',
-- Цвет фона окна (hex-формат); используется если прозрачность отключена; чёрный (#000000) — стандарт для невидимости
own_window_colour = '#000000',

-- Производительность
-- Включает двойную буферизацию (рисование в off-screen буфере); снижает мерцание при обновлениях, но увеличивает использование памяти
double_buffer = true,
-- Отключает буферизацию вывода (true = без буферов для скорости, но может вызвать артефакты); false = использует стандартные буферы для стабильности
no_buffers = false,
-- Размер буфера для текста (в байтах); больший — для сложных шаблонов с переменными, предотвращает обрезание длинного вывода
text_buffer_size = 2048,

-- Размеры и позиционирование
-- Минимальная ширина окна Conky в пикселях; предотвращает сжатие при малом контенте
minimum_width = 420,
-- Максимальная ширина окна (0 = без лимита); фиксирует для предсказуемого вида, полезно для панелей
maximum_width = 420,
-- Выравнивание окна: 'top_left/middle_right/bottom_center' и т.д.; определяет стартовую позицию относительно экрана
alignment = 'top_right',
-- Отступ по горизонтали от края экрана (в пикселях); положительное = от правого/левого края в зависимости от alignment
gap_x = 40,
-- Отступ по вертикали от края экрана; полезно для избежания перекрытия панелей (типа polybar)
gap_y = 30,

    -- Цветовая схема
    draw_shades = false,
    draw_outline = false,
    draw_borders = false,
    default_color = '#E1E1E6',
    color0 = '#FF5E13',      -- оранжево-красный (часы)
    color1 = '#BABABA',      -- серый (ключи)
    color2 = '#FFFFFF',      -- белый (значения)
    color3 = '#FF8C00',      -- акцент / проценты
    color4 = '#69a9ff',      -- голубой для дисков и RAM

    -- Сглаживание
    override_utf8_locale = true,

    -- Сэмплы для сглаживания значений
    net_avg_samples = 2,
    cpu_avg_samples = 2,
};

conky.text = [[
# Часы
${alignc}${font DejaVu Sans:size=44}${color0}${time %H:%M}${font}
${alignc}${font DejaVu Sans:size=15}${color0}${time %A, %d %B %Y}${font}${color}
# Мониторинг железа
${color1}Host:   ${color2}${nodename}
${color1}Uptime: ${color2}${uptime}
${color1}Kernel: ${color2}${kernel}
${color1}CPU:    ${color2}${cpu cpu0}% ${color3}[${hwmon 2 temp 1}°C]
${color1}RAM:    ${color2}${mem} / ${memmax} ${color3}[${memperc}%]
${color1}WiFi:   ${color2}${wireless_essid wlan0} ${color3}[${wireless_link_qual_perc wlan0}%]
${color1}IP: ${color2}${execi 60 curl -s --max-time 15 ifconfig.me}
# Использование дисков
${hr 1}
${color1}Диски свободно/всего:
${color1}/root:  ${color4}${fs_free /} / ${fs_size /} (${fs_free_perc /}%) - ${fs_type /}
${color1}/home:  ${color4}${fs_free /home/als} / ${fs_size /home/als} (${fs_free_perc /home/als}%) - ${fs_type /home/als}
${color1}/Data:  ${color4}${fs_free /run/media/als/Data} / ${fs_size /run/media/als/Data} (${fs_free_perc /run/media/als/Data}%) - ${fs_type /run/media/als/Data}
${color1}/Work:  ${color4}${fs_free /run/media/als/Work} / ${fs_size /run/media/als/Work} (${fs_free_perc /run/media/als/Work}%) - ${fs_type /run/media/als/Work}
# Погода
${hr 1}
${color3}Погода: ${color2}Омск  \
${execi 600 curl -s --max-time 15 'https://wttr.in/Omsk?format=%t' | grep -oE '[-+][0-9]+°C|[0-9]+°C'}
# Курсы валют
#С сайта ЦБ РФ
#${color3}USD: ${color2}${execi 300 curl -s --max-time 15 "https://www.cbr-xml-daily.ru/daily_json.js" | jq -r '.Valute.USD.Value' | xargs printf "%.2f"}₽ \
#${color3}EUR: ${color2}${execi 300 curl -s --max-time 15 "https://www.cbr-xml-daily.ru/daily_json.js" | jq -r '.Valute.EUR.Value' | xargs printf "%.2f"}₽
# Парсинг с сайта banki.ru, при смене кода сайта может сломаться
${color3}USD: ${color2}${execi 1200 curl -s "https://www.banki.ru/products/currency/cb/" | tr -d '\n' | grep -oP 'США.*?Курс ЦБ РФ.*?\K[0-9]{2,3},[0-9]{2}' | head -1 | tr ',' '.' | xargs printf "%.2f"}₽ \
${color3}EUR: ${color2}${execi 1200 curl -s "https://www.banki.ru/products/currency/cb/" | tr -d '\n' | grep -oP 'Евро.*?₽.*?\K[0-9]{2,3},[0-9]{2}' | head -1 | tr ',' '.' | xargs printf "%.2f"}₽
# Процессы
${hr 1}
${color1}Топ 5 процессов (CPU и MEM):
${color1}${goto 10}Имя${goto 190}PID${goto 230}CPU%${goto 290}MEM%
${color2}${goto 10}${top name 1}${goto 170}${top pid 1}${goto 230}${top cpu 1}${goto 290}${top mem 1}
${color2}${goto 10}${top name 2}${goto 170}${top pid 2}${goto 230}${top cpu 2}${goto 290}${top mem 2}
${color2}${goto 10}${top name 3}${goto 170}${top pid 3}${goto 230}${top cpu 3}${goto 290}${top mem 3}
${color2}${goto 10}${top name 4}${goto 170}${top pid 4}${goto 230}${top cpu 4}${goto 290}${top mem 4}
${color2}${goto 10}${top name 5}${goto 170}${top pid 5}${goto 230}${top cpu 5}${goto 290}${top mem 5}
${hr 1}
# Новости
# Tproger
#${execi 600 curl -4 -s --max-time 15 -L https://tproger.ru/feed | sed -n '/<item>/,/<\/item>/s/.*<title>\(.*\)<\/title>.*/\1/p' | awk 'length($0)<=42 {print; if (NR==5) exit}'}
# OpenNet
${execi 600 curl -s --max-time 15 https://www.opennet.ru/opennews/opennews_all_utf.rss | sed -n 's/.*<title>\(.*\)<\/title>.*/\1/p' | awk 'length($0)<=42' | sed 1,2d | head -5}
# CNews
${execi 600 curl -s --max-time 15 https://www.cnews.ru/inc/rss/news.xml | sed -n 's/.*<title>\(.*\)<\/title>.*/\1/p' | awk 'length($0)<=42' | sed 1,2d | head -5}
# Linux.org.ru
${execi 600 curl -4 -s --max-time 15 -L http://linux.org.ru/rss.xml | sed -n 's/.*<title>\(.*\)<\/title>.*/\1/p' | awk 'length($0)<=42' | sed 1,2d | head -5}
]]
